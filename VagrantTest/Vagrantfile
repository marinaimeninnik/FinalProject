Vagrant.configure("2") do |config|
  config.vm.box = "generic/ubuntu2004"

  # config.vm.box_download_insecure=true

  config.vm.network "public_network", ip: "192.168.0.220"

  config.vm.synced_folder '.', '/vagrant', disabled: true #turns off synced directory for successful running from win11 wsl

  config.vm.provider "virtualbox" do |v|
   # v.gui = true #launches gui
    v.memory = "4096"
    v.cpus = 4
    v.customize ["modifyvm", :id, "--uart1", "0x3F8", "4"]               #vagrant issue with hanging on ssh connection
    v.customize ["modifyvm", :id, "--uartmode1", "file", File::NULL]     #
  end

  config.vm.provider "virtualbox" do |vb|                                 #vagrant issue with hanging on ssh connection
    vb.customize [ "modifyvm", :id, "--uartmode1", "disconnected" ]       #
    vb.customize ["modifyvm", :id, "--cableconnected1", "on"]             #
  end

  config.vbguest.auto_update = false

 # Run Ansible from the Vagrant Host

  config.vm.provision "ansible" do |ansible|
    ansible.playbook = "playbook.yaml"
    extra_vars = "hosts= vagrant user=vagrant"
  end

end